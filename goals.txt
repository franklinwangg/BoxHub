why is renderEachLevel returning undefined?